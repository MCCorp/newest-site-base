$(document).ready(function(){var home=$("#home").val();$(".search-form-header").select2({placeholder:"Search for Stores...",minimumInputLength:2,multiple:true,ajax:{url:home+"/search/",dataType:"json",quietMillis:250,data:function(term,page){return{keyword:term,page:page}},results:function(data,page){var more=page*30<data.total_count;return{results:data.items,more:more}},cache:true},formatResult:searchFormatResult,formatSelection:searchFormatSelection,dropdownCssClass:"bigdrop",escapeMarkup:function(m){return m}}).on("select2-selecting",function(e){if(e.object.type=="store"){var alias=e.object.note==="ngach"?e.object.alias:e.object.alias;window.location=home+"/stores/"+alias+"/coupons"}else if(e.object.type=="coupon"){window.open(home+"/stores/"+e.object.store_alias+"/coupons?c="+e.object.coupon_key,"_blank");window.open(home+"/go/"+"/"+e.object.coupon_key,"_self")}else{window.open("?d="+e.object.coupon_key,"_blank");window.open(home+"/go/"+"/"+e.object.coupon_key,"_self")}});function searchFormatResult(repo){var markup="";if(repo.type=="store"||repo.type=="deal"){markup='<div class="row">'+'<div class="col-sm-12">'+'<div class="">'+"<div><b>"+repo.title+"</b></div>"+"</div></div></div>"}else{markup='<div class="row">'+'<div class="col-sm-4">';if(repo.coupon_type=="COUPON CODE"){markup+='<figcaption class="search-coupon"><samp class="btn-coupon-small">';if(repo.exclusive==1)markup+='<span class="exclu-stamp">Exclusive</span>';markup+="<strong>"+repo.discount+"<sup>"+repo.currency+"</sup>"+"</strong><span>Discount</span></samp></figcaption>"}else if(repo.coupon_type=="FREE SHIPPING"){markup+='<figcaption class="search-free"><samp class="btn-coupon-small">';if(repo.exclusive==1)markup+='<span class="exclu-stamp">Exclusive</span>';markup+="<strong>Free</strong><span></span></samp></figcaption>"}else{markup+='<figcaption class="search-deal"><samp class="btn-coupon-small">';if(repo.exclusive==1)markup+='<span class="exclu-stamp">Exclusive</span>';markup+="<strong>Great</strong><span>Offer</span></samp></figcaption>"}markup+="</div>"+'<div class="col-sm-8">'+'<div class="">'+"<div><b>"+repo.title+"</b></div>"+"<div>"+repo.description+"</div>"+"</div></div></div>"}return markup}function searchFormatSelection(repo){return repo.title}});function openGo(aff,c){location.href=aff;window.open("?c="+c,"_blank")}function openRev(aff,c){location.href="?c="+c;window.open(aff,"_blank")}function openGoEv(is){var aff=$(is).attr("data-aff"),c=$(is).attr("data-goid");openGo(aff,c)}function openGo_Rev(is){var aff=$(is).attr("data-aff"),c=$(is).attr("data-goid");openRev(aff,c)}$(document).on("click",".go-btn .get-code",function(){openGoEv(this)});$(document).on("click",".go-btn .get-deal",function(){openGo_Rev(this)});